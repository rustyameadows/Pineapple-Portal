<% provide :page_shell do %>
  <div class="event-layout">
    <%= render "events/sidebar_navigation", event: @event %>

    <div class="event-layout__main">
      <%= render "shared/flash" %>

      <section class="event-section">
        <header class="event-section__header event-section__header--split">
          <div>
            <p class="event-section__eyebrow">Documents</p>
            <h1 class="event-section__title">Upload document</h1>
            <% if @existing_versions.any? %>
              <p class="event-section__lead">This will be saved as version v<%= @next_version_number %> of the existing file (<code><%= @existing_versions.first.logical_id %></code>).</p>
            <% else %>
              <p class="event-section__lead">Select a file, upload it to storage, and share it with your planners or clients.</p>
            <% end %>
          </div>
          <div class="event-section__actions">
            <%= link_to "Back", event_documents_path(@event), class: "event-section__cta event-section__cta--secondary" %>
          </div>
        </header>

        <div class="event-section__body documents-form">
          <section class="documents-form__panel">
            <%= render "form" %>
          </section>

          <% if @existing_versions.any? %>
            <section class="documents-form__panel">
              <h2 class="documents-form__heading">Existing versions</h2>
              <%= render "documents/table",
                        documents: @existing_versions,
                        title_link: ->(document) { event_document_path(@event, document) },
                        show_visibility: false,
                        show_source: false,
                        show_uploader: false,
                        empty_message: "No previous versions found." %>
            </section>
          <% end %>
        </div>
      </section>
    </div>
  </div>
<% end %>

<%= render "documents/upload_script" %>
