<% if local_assigns.fetch(:render_base_styles, true) %>
  <%= render "generated_documents/sections/base_styles" %>
<% end %>

<style>
  .generated-template--timeline {
    gap: 1.5rem;
  }

  .generated-template--timeline table td:nth-child(2) {
    white-space: nowrap;
  }

  .generated-template--timeline__note {
    font-size: 0.9rem;
    color: #5b4639;
    font-style: italic;
  }
</style>

<div class="generated-template generated-template--timeline">
  <%= render "generated_documents/sections/page_header", segment: @segment %>
  <% calendar = @event.run_of_show_calendar %>
  <% if calendar.present? && calendar.calendar_items.any? %>
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Starts</th>
          <th>Vendor</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <% calendar.calendar_items.order(:starts_at).limit(10).each do |item| %>
          <tr>
            <td><%= item.title %></td>
            <td><%= item.starts_at&.to_fs(:long) || "TBD" %></td>
            <td><%= item.vendor_name.presence || "â€”" %></td>
            <td><%= item.status.humanize %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <% if calendar.calendar_items.count > 10 %>
      <p class="generated-template--timeline__note">Showing first 10 milestones.</p>
    <% end %>
  <% else %>
    <p class="generated-template__muted">No milestones have been added to the run-of-show yet.</p>
  <% end %>
</div>
